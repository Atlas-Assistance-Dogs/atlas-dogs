minimum_cumulusci_version: '3.26.0'
project:
    name: atlas-dog
    package:
        name: atlas-dogs
        api_version: '50.0'
    dependencies:
        - github: 'https://github.com/SalesforceFoundation/NPSP'
        - namespace: 'zoom_app'
          version: 3.12
    git:
    source_format: sfdx

tasks:
    robot:
        options:
            suites: robot/atlas-dog/tests
            options:
                outputdir: robot/atlas-dog/results

    robot_testdoc:
        options:
            path: robot/atlas-dog/tests
            output: robot/atlas-dog/doc/atlas-dog_tests.html

    run_tests:
        options:
            required_org_code_coverage_percent: 75
flows:
    config_qa:
        steps:
            2:
                task: dx_push
                when: org_config.scratch
            3:
                task: assign_permission_sets
                options:
                    api_names: Atlas_Super_User
            4:
                task: dx
                options:
                    command: force:source:deploy
                    extra: -p force-app2/main/default
            5:
                task: dx
                options:
                    command: force:data:tree:import
                    extra: -p datasets/Account-Contact-plan.json
            6:
                task: dx
                options:
                    command: force:data:tree:import
                    extra: -f datasets/Dog__c.json,datasets/Course_Master__c.json
    config_dev:
        steps:
            2:
                task: dx_push
                when: org_config.scratch
            3:
                task: assign_permission_sets
                options:
                    api_names: Atlas_Super_User
            4:
                task: dx
                options:
                    command: force:source:deploy
                    extra: -p force-app2/main/default
            5:
                task: dx
                options:
                    command: force:data:tree:import
                    extra: -p datasets/Account-Contact-plan.json
            6:
                task: dx
                options:
                    command: force:data:tree:import
                    extra: -f datasets/Dog__c.json,datasets/Course_Master__c.json
